<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fits Latent Class Models for Data Containing Group Variable and Covariates — glca • glca</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fits Latent Class Models for Data Containing Group Variable and Covariates — glca" />
<meta property="og:description" content="Function for fitting latent class models with multiple groups, which may or may not include latent class structure for group variable." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glca</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kim0sun/glca/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits Latent Class Models for Data Containing Group Variable and Covariates</h1>
    <small class="dont-index">Source: <a href='https://github.com/kim0sun/glca/blob/master/R/glca.R'><code>R/glca.R</code></a></small>
    <div class="hidden name"><code>glca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function for fitting latent class models with multiple groups, which may or may not include latent class structure for group variable.</p>
    </div>

    <pre class="usage"><span class='fu'>glca</span>(
  <span class='kw'>formula</span>,
  group = <span class='kw'>NULL</span>,
  data = <span class='kw'>NULL</span>,
  nclass = <span class='fl'>3</span>,
  ncluster = <span class='kw'>NULL</span>,
  std.err = <span class='fl'>TRUE</span>,
  measure.inv = <span class='fl'>TRUE</span>,
  coeff.inv = <span class='fl'>TRUE</span>,
  init.param = <span class='kw'>NULL</span>,
  n.init = <span class='fl'>10</span>,
  testiter = <span class='fl'>50</span>,
  maxiter = <span class='fl'>5000</span>,
  eps = <span class='fl'>1e-06</span>,
  na.rm = <span class='fl'>FALSE</span>,
  seed = <span class='kw'>NULL</span>,
  verbose = <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a formula for specifying manifest items and covariates using the "<code>item</code>" function.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>an optional vector specifying a group of observations. Given group variable, group covariates can be incorporated.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data frame containing the manifest item, covariates and group variable.</p></td>
    </tr>
    <tr>
      <th>nclass</th>
      <td><p>number of level-1 (individual-level) latent classes.</p></td>
    </tr>
    <tr>
      <th>ncluster</th>
      <td><p>number of level-2 (group-level) latent classes. When <code>group</code> and <code>ncluster</code> (&gt;1) are given the multilevel latent class models will be fitted.</p></td>
    </tr>
    <tr>
      <th>std.err</th>
      <td><p>a logical value for whether calculating standard errors for estimates.</p></td>
    </tr>
    <tr>
      <th>measure.inv</th>
      <td><p>a logical value of the measurement invariance assumption across groups.</p></td>
    </tr>
    <tr>
      <th>coeff.inv</th>
      <td><p>a logical value of the coefficient invariance assumption across groups (random intercept model).</p></td>
    </tr>
    <tr>
      <th>init.param</th>
      <td><p>A set of model parameters to be used as the user-defined initial values for the EM algorithm. It should be <code>list</code> with the named parameters and have same structure of <code>param</code> of the <code>glca</code> output. In default, initial parameters are randomly generated.</p></td>
    </tr>
    <tr>
      <th>n.init</th>
      <td><p>number of randomly generated initial parameter sets to be used for avoiding the problem of local maxima.</p></td>
    </tr>
    <tr>
      <th>testiter</th>
      <td><p>number of iterations in the EM algorithm for each initial parameter set. The initial parameter set that provides the largest log-likelihood will be selected for estimating the model.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>maximum number of iterations for the EM algorithm.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>a convergence tolerance value. When the largest absolute difference between former estimates and current estimates is less than <code>eps</code>, the algorithm will stop updating and consider the convergence to be reached.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>a logical value for deleting the lines that have at least one missing manifest item. If <code>na.rm = FALSE</code>, MAR procedure will be conducted.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>In default, the set of initial parameters is drawn randomly. As the same value for seed guarantees the same initial parameters to be drawn, this argument can be used for reproducibility of estimation results.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>a logical value indicating whether <code>glca</code> should print the estimation procedure onto the screen.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>glca</code> returns an object of class "<code>glca</code>".</p>
<p>The function <code>summary</code> prints estimates for parameters and <code>glca.gof</code> function gives goodness of fit measures for the model.</p>
<p>An object of class "<code>glca</code>" is a list containing the following components:</p>
<dt>call</dt><dd><p>the matched call.</p></dd>
<dt>terms</dt><dd><p>the <code><a href='https://rdrr.io/r/stats/terms.html'>terms</a></code> object used.</p></dd>
<dt>model</dt><dd><p>a <code>list</code> of model description.</p></dd>
<dt>var.names</dt><dd><p>a <code>list</code> of names of data.</p></dd>
<dt>datalist</dt><dd><p>a <code>list</code> of data used for fitting.</p></dd>
<dt>param</dt><dd><p>a <code>list</code> of parameter estimates.</p></dd>
<dt>std.err</dt><dd><p>a <code>list</code> of standard errors for estimates.</p></dd>
<dt>coefficient</dt><dd><p>a <code>list</code> of logistic regression coefficients for prevalence of level-1 class.</p></dd>
<dt>posterior</dt><dd><p>a <code>data.frame</code> or a <code>list</code> of posterior probablities of each individaul for latent classes and each group for latent clusters.</p></dd>
<dt>gof</dt><dd><p>a <code>list</code> of goodness of fit measures.</p></dd>
<dt>convergence</dt><dd><p>a <code>list</code> containing information about convergence.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>glca</code> is the function for implementing LCA consist of two-type latent categorical variables (i.e., level-1 and level-2 latent class). The level-1 (individual-level) latent class is identified by the association among the individuals' responses to multiple manifest items, but level-2 (group-level) latent class is categorized by the prevalence of level-1 latent class for group variable. The function <code>glca</code> can handle two types of covariates: level-1 and level-2 covariates. If covariates vary across individuals, they are considered as level-1 covariates. When <code>group</code> and <code>ncluster</code> (&gt;1) are given, covariates which are varying across groups are considered as level-2 covariates. Both types of covariates have effect on level-1 class prevalence.</p>
<p>The formula should consist of an <code><a href='https://rdrr.io/r/base/tilde.html'>~</a></code> operator between two sides. Manifest items should be indicated in LHS of formula using <code>item</code> function and covariates should be specified in RHS of formula. For example, <br />
<code>item(y1, y2, y3) ~ 1</code><br />
<code>item(y1, y2, y3) ~ x1 + x2</code><br />
where the first fomula indicates LCA with three manifest variables (<code>y1</code>, <code>y2</code>, and <code>y3</code>) and no covariate, and the second formula includes two covariates (<code>x1</code> and <code>x2</code>). Two types of covariates (i.e., level-1 and level-2 covariates) will be automatically detected by <code>glca</code>.</p>
<p>The estimated parameters in <code>glca</code> are <code>rho</code>, <code>gamma</code>, <code>delta</code>, and <code>beta</code>. The set of item response probabilities for each level-1 class is <code>rho</code>. The sets of prevalences for level-1 and level-2 class are <code>gamma</code> and <code>delta</code>, respectively. The prevalence for level-1 class (i.e., <code>gamma</code>) can be modeled as logistic regression using level-1 and/or level-2 covariates. The set of logistic regression coefficients is <code>beta</code> in <code>glca</code> output.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Vermunt, J.K. (2003) Multilevel latent class models. <em>Sociological Methodology</em>, <b>33</b>, 213--239. doi: <a href='https://doi.org/10.1111/j.0081-1750.2003.t01-1-00131.x'>10.1111/j.0081-1750.2003.t01-1-00131.x</a></p>
<p>Collins, L.M. and Lanza, S.T. (2009) <em>Latent Class and Latent Transition Analysis: With Applications in the Social, Behavioral, and Health Sciences</em>. John Wiley &amp; Sons Inc.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gss08.html'>gss08</a></code> <code><a href='nyts18.html'>nyts18</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Youngsun Kim</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##</span>
<span class='co'>## Example 1. GSS dataset</span>
<span class='co'>##</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"gss08"</span>)
<span class='co'># LCA</span>
<span class='kw'>lca</span> <span class='op'>=</span> <span class='fu'>glca</span>(<span class='fu'><a href='item.html'>item</a></span>(<span class='kw'>DEFECT</span>, <span class='kw'>HLTH</span>, <span class='kw'>RAPE</span>, <span class='kw'>POOR</span>, <span class='kw'>SINGLE</span>, <span class='kw'>NOMORE</span>) <span class='op'>~</span> <span class='fl'>1</span>,
            data = <span class='kw'>gss08</span>, nclass = <span class='fl'>3</span>)
</div><div class='output co'>#&gt; Manifest items :
#&gt;  DEFECT HLTH RAPE POOR SINGLE NOMORE 
#&gt; 
#&gt; Deleted observation(s) : 
#&gt; 3 observation(s) for missing all manifest items
#&gt; 0 observation(s) for missing at least 1 covariates
#&gt; 
#&gt; SET : 1  .....loglik : -692.2331 
#&gt; SET : 2  .....loglik : -687.4487 
#&gt; SET : 3  .....loglik : -687.4489 
#&gt; SET : 4  .....loglik : -687.4486 
#&gt; SET : 5  .....loglik : -687.4493 
#&gt; SET : 6  .....loglik : -687.4486 
#&gt; SET : 7  .....loglik : -687.449 
#&gt; SET : 8  .....loglik : -687.4486 
#&gt; SET : 9  .....loglik : -687.4486 
#&gt; SET : 10 .....loglik : -687.4486 
#&gt; 
#&gt; Start with SET 10 (-687.4486)
#&gt; 
#&gt; Standard latent class analysis Fitting...
#&gt; 
#&gt;  53 iteration 
#&gt; 
#&gt; Converged at 53 iteration (loglik :-687.4486)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>lca</span>)
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; glca(formula = item(DEFECT, HLTH, RAPE, POOR, SINGLE, NOMORE) ~ 
#&gt;     1, data = gss08, nclass = 3)
#&gt; 
#&gt; Manifest items : DEFECT HLTH RAPE POOR SINGLE NOMORE 
#&gt; 
#&gt; Categories for manifest items :
#&gt;        Y = 1 Y = 2
#&gt; DEFECT   YES    NO
#&gt; HLTH     YES    NO
#&gt; RAPE     YES    NO
#&gt; POOR     YES    NO
#&gt; SINGLE   YES    NO
#&gt; NOMORE   YES    NO
#&gt; 
#&gt; Model : Standard latent class analysis 
#&gt; 
#&gt; Number of latent classes : 3 
#&gt; Number of observations : 352 
#&gt; Number of parameters : 20 
#&gt; 
#&gt; log-likelihood : -687.4486 
#&gt;      G-squared : 29.82695 
#&gt;            AIC : 1414.897 
#&gt;            BIC : 1492.17 
#&gt; 
#&gt; Marginal prevalences for latent classes :
#&gt; Class 1 Class 2 Class 3 
#&gt; 0.19137 0.46396 0.34467 
#&gt; 
#&gt; Class prevalences by group :
#&gt;     Class 1 Class 2 Class 3
#&gt; ALL 0.19137 0.46396 0.34467
#&gt; 
#&gt; Rho (Y = 1) :
#&gt;         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE
#&gt; Class 1 0.0466 0.3684 0.0949 0.0000 0.0000 0.0000
#&gt; Class 2 1.0000 1.0000 1.0000 0.9813 0.9284 0.9657
#&gt; Class 3 0.8275 0.9453 0.7959 0.0638 0.0390 0.1344
#&gt; 
#&gt; Rho (Y = 2) :
#&gt;         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE
#&gt; Class 1 0.9534 0.6316 0.9051 1.0000 1.0000 1.0000
#&gt; Class 2 0.0000 0.0000 0.0000 0.0187 0.0716 0.0343
#&gt; Class 3 0.1725 0.0547 0.2041 0.9362 0.9610 0.8656</div><div class='input'>
<span class='co'># LCA with covariate(s)</span>
<span class='kw'>lcr</span> <span class='op'>=</span> <span class='fu'>glca</span>(<span class='fu'><a href='item.html'>item</a></span>(<span class='kw'>DEFECT</span>, <span class='kw'>HLTH</span>, <span class='kw'>RAPE</span>, <span class='kw'>POOR</span>, <span class='kw'>SINGLE</span>, <span class='kw'>NOMORE</span>) <span class='op'>~</span> <span class='kw'>AGE</span>,
           data = <span class='kw'>gss08</span>, nclass = <span class='fl'>3</span>)
</div><div class='output co'>#&gt; <span class='error'>Error: `levels.haven_labelled()` not supported.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>lcr</span>)
</div><div class='output co'>#&gt; <span class='error'>Error in summary(lcr): 객체 'lcr'를 찾을 수 없습니다</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='kw'>lcr</span>)
</div><div class='output co'>#&gt; <span class='error'>Error in coef(lcr): 객체 'lcr'를 찾을 수 없습니다</span></div><div class='input'>
<span class='co'># Multiple-group LCA (MGLCA)</span>
<span class='kw'>mglca</span> <span class='op'>=</span> <span class='fu'>glca</span>(<span class='fu'><a href='item.html'>item</a></span>(<span class='kw'>DEFECT</span>, <span class='kw'>HLTH</span>, <span class='kw'>RAPE</span>, <span class='kw'>POOR</span>, <span class='kw'>SINGLE</span>, <span class='kw'>NOMORE</span>) <span class='op'>~</span> <span class='fl'>1</span>,
             group = <span class='kw'>DEGREE</span>, data = <span class='kw'>gss08</span>, nclass = <span class='fl'>3</span>)
</div><div class='output co'>#&gt; Manifest items :
#&gt;  DEFECT HLTH RAPE POOR SINGLE NOMORE 
#&gt; Grouping variable : DEGREE 
#&gt; 
#&gt; Deleted observation(s) : 
#&gt; 3 observation(s) for missing all manifest items
#&gt; 0 observation(s) for missing at least 1 covariates
#&gt; 
#&gt; SET : 1  .....loglik : -676.4602 
#&gt; SET : 2  .....loglik : -672.9036 
#&gt; SET : 3  .....loglik : -676.4119 
#&gt; SET : 4  .....loglik : -672.414 
#&gt; SET : 5  .....loglik : -672.4139 
#&gt; SET : 6  .....loglik : -672.4171 
#&gt; SET : 7  .....loglik : -680.8428 
#&gt; SET : 8  .....loglik : -672.4139 
#&gt; SET : 9  .....loglik : -672.417 
#&gt; SET : 10 .....loglik : -676.4533 
#&gt; 
#&gt; Start with SET 8 (-672.4139)
#&gt; 
#&gt; Multiple-group latent class analysis Fitting...
#&gt; 
#&gt;  78 iteration 
#&gt; 
#&gt; Converged at 78 iteration (loglik :-672.4138)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>mglca</span>)
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; glca(formula = item(DEFECT, HLTH, RAPE, POOR, SINGLE, NOMORE) ~ 
#&gt;     1, group = DEGREE, data = gss08, nclass = 3)
#&gt; 
#&gt; Manifest items : DEFECT HLTH RAPE POOR SINGLE NOMORE 
#&gt; Grouping variable : DEGREE 
#&gt; 
#&gt; Categories for manifest items :
#&gt;        Y = 1 Y = 2
#&gt; DEFECT   YES    NO
#&gt; HLTH     YES    NO
#&gt; RAPE     YES    NO
#&gt; POOR     YES    NO
#&gt; SINGLE   YES    NO
#&gt; NOMORE   YES    NO
#&gt; 
#&gt; Model : Multiple-group latent class analysis 
#&gt; 
#&gt; Number of latent classes : 3 
#&gt; Number of groups : 4 
#&gt; Number of observations : 352 
#&gt; Number of parameters : 26 
#&gt; 
#&gt; log-likelihood : -672.4138 
#&gt;      G-squared : 87.85135 
#&gt;            AIC : 1396.828 
#&gt;            BIC : 1497.282 
#&gt; 
#&gt; Marginal prevalences for latent classes :
#&gt; Class 1 Class 2 Class 3 
#&gt; 0.34468 0.46148 0.19384 
#&gt; 
#&gt; Class prevalences by group :
#&gt;             Class 1 Class 2 Class 3
#&gt; &lt;= HS       0.51954 0.16850 0.31196
#&gt; HIGH SCHOOL 0.34862 0.44393 0.20745
#&gt; COLLEGE     0.29846 0.55348 0.14806
#&gt; GRADUATE    0.20439 0.71186 0.08375
#&gt; 
#&gt; Rho (Y = 1) :
#&gt;         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE
#&gt; Class 1 0.8318 0.9470 0.7999 0.0690 0.0433 0.1389
#&gt; Class 2 1.0000 1.0000 1.0000 0.9835 0.9309 0.9681
#&gt; Class 3 0.0507 0.3724 0.0995 0.0000 0.0000 0.0000
#&gt; 
#&gt; Rho (Y = 2) :
#&gt;         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE
#&gt; Class 1 0.1682 0.0530 0.2001 0.9310 0.9567 0.8611
#&gt; Class 2 0.0000 0.0000 0.0000 0.0165 0.0691 0.0319
#&gt; Class 3 0.9493 0.6276 0.9005 1.0000 1.0000 1.0000</div><div class='input'>

<span class='co'># Multiple-group LCA with covariate(s) (MGLCR)</span>
<span class='kw'>mglcr</span> <span class='op'>=</span> <span class='fu'>glca</span>(<span class='fu'><a href='item.html'>item</a></span>(<span class='kw'>DEFECT</span>, <span class='kw'>HLTH</span>, <span class='kw'>RAPE</span>, <span class='kw'>POOR</span>, <span class='kw'>SINGLE</span>, <span class='kw'>NOMORE</span>) <span class='op'>~</span> <span class='kw'>SEX</span>,
             group = <span class='kw'>DEGREE</span>, data = <span class='kw'>gss08</span>, nclass = <span class='fl'>3</span>)
</div><div class='output co'>#&gt; Manifest items :
#&gt;  DEFECT HLTH RAPE POOR SINGLE NOMORE 
#&gt; Grouping variable : DEGREE 
#&gt; Covariates (Level 1) : 
#&gt;  SEX 
#&gt; 
#&gt; Deleted observation(s) : 
#&gt; 3 observation(s) for missing all manifest items
#&gt; 0 observation(s) for missing at least 1 covariates
#&gt; 
#&gt; SET : 1  .....loglik : -666.7221 
#&gt; SET : 2  .....loglik : -666.71 
#&gt; SET : 3  .....loglik : -666.7787 
#&gt; SET : 4  .....loglik : -666.7097 
#&gt; SET : 5  .....loglik : -666.7122 
#&gt; SET : 6  .....loglik : -666.71 
#&gt; SET : 7  .....loglik : -666.7113 
#&gt; SET : 8  .....loglik : -666.7098 
#&gt; SET : 9  .....loglik : -666.7265 
#&gt; SET : 10 .....loglik : -678.3504 
#&gt; 
#&gt; Start with SET 4 (-666.7097)
#&gt; 
#&gt; Multiple-group latent class analysis Fitting...
#&gt; 
#&gt;  90 iteration 
#&gt; 
#&gt; Converged at 90 iteration (loglik :-666.7097)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>mglcr</span>)
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; glca(formula = item(DEFECT, HLTH, RAPE, POOR, SINGLE, NOMORE) ~ 
#&gt;     SEX, group = DEGREE, data = gss08, nclass = 3)
#&gt; 
#&gt; Manifest items : DEFECT HLTH RAPE POOR SINGLE NOMORE 
#&gt; Grouping variable : DEGREE 
#&gt; Covariates (Level 1) : SEX 
#&gt; 
#&gt; Categories for manifest items :
#&gt;        Y = 1 Y = 2
#&gt; DEFECT   YES    NO
#&gt; HLTH     YES    NO
#&gt; RAPE     YES    NO
#&gt; POOR     YES    NO
#&gt; SINGLE   YES    NO
#&gt; NOMORE   YES    NO
#&gt; 
#&gt; Model : Multiple-group latent class analysis 
#&gt; 
#&gt; Number of latent classes : 3 
#&gt; Number of groups : 4 
#&gt; Number of observations : 352 
#&gt; Number of parameters : 28 
#&gt; 
#&gt; log-likelihood : -666.7097 
#&gt;      G-squared : 149.9656 
#&gt;            AIC : 1389.419 
#&gt;            BIC : 1497.601 
#&gt; 
#&gt; Marginal prevalences for latent classes :
#&gt; Class 1 Class 2 Class 3 
#&gt; 0.19860 0.46144 0.33996 
#&gt; 
#&gt; Class prevalences by group :
#&gt;             Class 1 Class 2 Class 3
#&gt; &lt;= HS       0.32143 0.16848 0.51010
#&gt; HIGH SCHOOL 0.21275 0.44386 0.34339
#&gt; COLLEGE     0.15036 0.55347 0.29616
#&gt; GRADUATE    0.08580 0.71183 0.20237
#&gt; 
#&gt; Beta :
#&gt; Group : &lt;= HS 
#&gt;             Class 1/3 Class 2/3
#&gt; (Intercept)   -1.1445   -1.0634
#&gt; SEXFEMALE      1.0306   -0.0834
#&gt; 
#&gt; Group : HIGH SCHOOL 
#&gt;             Class 1/3 Class 2/3
#&gt; (Intercept)   -1.1261    0.2979
#&gt; SEXFEMALE      1.0306   -0.0834
#&gt; 
#&gt; Group : COLLEGE 
#&gt;             Class 1/3 Class 2/3
#&gt; (Intercept)   -1.3487    0.6686
#&gt; SEXFEMALE      1.0306   -0.0834
#&gt; 
#&gt; Group : GRADUATE 
#&gt;             Class 1/3 Class 2/3
#&gt; (Intercept)   -1.3620    1.2872
#&gt; SEXFEMALE      1.0306   -0.0834
#&gt; 
#&gt; Rho (Y = 1) :
#&gt;         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE
#&gt; Class 1 0.0649 0.3825 0.0989 0.0000 0.0000 0.0000
#&gt; Class 2 1.0000 1.0000 1.0000 0.9836 0.9309 0.9682
#&gt; Class 3 0.8342 0.9488 0.8086 0.0700 0.0440 0.1409
#&gt; 
#&gt; Rho (Y = 2) :
#&gt;         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE
#&gt; Class 1 0.9351 0.6175 0.9011 1.0000 1.0000 1.0000
#&gt; Class 2 0.0000 0.0000 0.0000 0.0164 0.0691 0.0318
#&gt; Class 3 0.1658 0.0512 0.1914 0.9300 0.9560 0.8591</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='kw'>mglcr</span>)
</div><div class='output co'>#&gt; Coefficients :
#&gt; 
#&gt; Class 1 / 3 :
#&gt;           Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    
#&gt; SEXFEMALE    2.80287     1.03064     0.09971    10.34    &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Class 2 / 3 :
#&gt;           Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)
#&gt; SEXFEMALE    0.92003    -0.08335     0.06815   -1.223     0.222
#&gt; </div><div class='input'>
<span class='co'># \donttest{</span>
<span class='co'>##</span>
<span class='co'>## Example 2. NYTS dataset</span>
<span class='co'>##</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"nyts18"</span>)
<span class='co'># Multilevel LCA (MLCA)</span>
<span class='kw'>mlca</span> <span class='op'>=</span> <span class='fu'>glca</span>(<span class='fu'><a href='item.html'>item</a></span>(<span class='kw'>ECIGT</span>, <span class='kw'>ECIGAR</span>, <span class='kw'>ESLT</span>, <span class='kw'>EELCIGT</span>, <span class='kw'>EHOOKAH</span>) <span class='op'>~</span> <span class='fl'>1</span>,
            group = <span class='kw'>SCH_ID</span>, data = <span class='kw'>nyts18</span>, nclass = <span class='fl'>3</span>, ncluster = <span class='fl'>2</span>)
</div><div class='output co'>#&gt; Manifest items :
#&gt;  ECIGT ECIGAR ESLT EELCIGT EHOOKAH 
#&gt; Grouping variable : SCH_ID 
#&gt; 
#&gt; Deleted observation(s) : 
#&gt; 0 observation(s) for missing all manifest items
#&gt; 0 observation(s) for missing at least 1 covariates
#&gt; 
#&gt; SET : 1  .....loglik : -1955.488 
#&gt; SET : 2  .....loglik : -1956.141 
#&gt; SET : 3  .....loglik : -1955.494 
#&gt; SET : 4  .....loglik : -1967.905 
#&gt; SET : 5  .....loglik : -1981.171 
#&gt; SET : 6  .....loglik : -1958.075 
#&gt; SET : 7  .....loglik : -1955.818 
#&gt; SET : 8  .....loglik : -1956.044 
#&gt; SET : 9  .....loglik : -1956.505 
#&gt; SET : 10 .....loglik : -1961.422 
#&gt; 
#&gt; Start with SET 1 (-1955.488)
#&gt; 
#&gt; Nonparametric multilevel latent class analysis Fitting...
#&gt; 
#&gt;  99 iteration 
#&gt; 
#&gt; Converged at 99 iteration (loglik :-1955.487)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>mlca</span>)
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; glca(formula = item(ECIGT, ECIGAR, ESLT, EELCIGT, EHOOKAH) ~ 
#&gt;     1, group = SCH_ID, data = nyts18, nclass = 3, ncluster = 2)
#&gt; 
#&gt; Manifest items : ECIGT ECIGAR ESLT EELCIGT EHOOKAH 
#&gt; Grouping variable : SCH_ID 
#&gt; 
#&gt; Categories for manifest items :
#&gt;         Y = 1 Y = 2
#&gt; ECIGT     Yes    No
#&gt; ECIGAR    Yes    No
#&gt; ESLT      Yes    No
#&gt; EELCIGT   Yes    No
#&gt; EHOOKAH   Yes    No
#&gt; 
#&gt; Model : Nonparametric multilevel latent class analysis 
#&gt; 
#&gt; Number of latent classes : 3 
#&gt; Number of latent clusters : 2 
#&gt; Number of groups : 45 
#&gt; Number of observations : 1734 
#&gt; Number of parameters : 20 
#&gt; 
#&gt; log-likelihood : -1955.487 
#&gt;      G-squared : 768.5035 
#&gt;            AIC : 3950.973 
#&gt;            BIC : 4060.137 
#&gt; 
#&gt; Marginal prevalences for latent classes :
#&gt; Class 1 Class 2 Class 3 
#&gt; 0.05960 0.17079 0.76961 
#&gt; 
#&gt; Marginal prevalences for latent clusters :
#&gt; Cluster 1 Cluster 2 
#&gt;    0.3793    0.6207 
#&gt; 
#&gt; Class prevalences by cluster :
#&gt;           Class 1 Class 2 Class 3
#&gt; Cluster 1 0.14137 0.34686 0.51177
#&gt; Cluster 2 0.00876 0.06129 0.92995
#&gt; Rho (Y = 1) :
#&gt;          ECIGT ECIGAR   ESLT EELCIGT EHOOKAH
#&gt; Class 1 0.9112 0.9750 0.5651  0.9778  0.5364
#&gt; Class 2 0.3489 0.2006 0.1236  0.7783  0.0443
#&gt; Class 3 0.0062 0.0043 0.0088  0.0413  0.0057
#&gt; 
#&gt; Rho (Y = 2) :
#&gt;          ECIGT ECIGAR   ESLT EELCIGT EHOOKAH
#&gt; Class 1 0.0888 0.0250 0.4349  0.0222  0.4636
#&gt; Class 2 0.6511 0.7994 0.8764  0.2217  0.9557
#&gt; Class 3 0.9938 0.9957 0.9912  0.9587  0.9943
#&gt; </div><div class='input'>
<span class='co'># MLCA with covariate(s) (MLCR)</span>
<span class='co'># (SEX: level-1 covariate, SCH_LEV: level-2 covariate)</span>
<span class='kw'>mlcr</span> <span class='op'>=</span> <span class='fu'>glca</span>(<span class='fu'><a href='item.html'>item</a></span>(<span class='kw'>ECIGT</span>, <span class='kw'>ECIGAR</span>, <span class='kw'>ESLT</span>, <span class='kw'>EELCIGT</span>, <span class='kw'>EHOOKAH</span>) <span class='op'>~</span> <span class='kw'>SEX</span> <span class='op'>+</span> <span class='kw'>SCH_LEV</span>,
            group = <span class='kw'>SCH_ID</span>, data = <span class='kw'>nyts18</span>, nclass = <span class='fl'>3</span>, ncluster = <span class='fl'>2</span>)
</div><div class='output co'>#&gt; Manifest items :
#&gt;  ECIGT ECIGAR ESLT EELCIGT EHOOKAH 
#&gt; Grouping variable : SCH_ID 
#&gt; Covariates (Level 2) : 
#&gt;  SCH_LEV 
#&gt; Covariates (Level 1) : 
#&gt;  SEX 
#&gt; 
#&gt; Deleted observation(s) : 
#&gt; 0 observation(s) for missing all manifest items
#&gt; 0 observation(s) for missing at least 1 covariates
#&gt; 
#&gt; SET : 1  .....loglik : -1931.942 
#&gt; SET : 2  .....loglik : -1944.834 
#&gt; SET : 3  .....loglik : -1921.208 
#&gt; SET : 4  .....loglik : -1927.774 
#&gt; SET : 5  .....loglik : -1943.428 
#&gt; SET : 6  .....loglik : -1941.785 
#&gt; SET : 7  .....loglik : -1919.957 
#&gt; SET : 8  .....loglik : -1919.982 
#&gt; SET : 9  .....loglik : -1942.637 
#&gt; SET : 10 .....loglik : -1919.96 
#&gt; 
#&gt; Start with SET 7 (-1919.957)
#&gt; 
#&gt; Nonparametric multilevel latent class analysis Fitting...
#&gt; 
#&gt; .. 209 iteration 
#&gt; 
#&gt; Converged at 209 iteration (loglik :-1919.937)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='kw'>mlcr</span>)
</div><div class='output co'>#&gt; 
#&gt; Level 1 Coefficients :
#&gt; 
#&gt; Class 1 / 3 :
#&gt;           Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)  
#&gt; SEXFemale     1.6733      0.5148      0.2180    2.362    0.0183 *
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Class 2 / 3 :
#&gt;           Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)
#&gt; SEXFemale     0.8906     -0.1159      0.1717   -0.675       0.5
#&gt; 
#&gt; 
#&gt; Level 2 Coefficients :
#&gt; 
#&gt; Class 1 / 3 :
#&gt;                      Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)
#&gt; SCH_LEVMiddle School     0.5415     -0.6134      0.6587   -0.931     0.352
#&gt; 
#&gt; Class 2 / 3 :
#&gt;                      Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    
#&gt; SCH_LEVMiddle School     7.0439      1.9522      0.4185    4.665  3.33e-06 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Youngsun Kim, Hwan Chung.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


